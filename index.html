<!DOCTYPE html>
<html>
<head>
  <title>Konnakkol</title>
  <script src="assets/konnakkol.ohm" type="text/ohm-js"></script>
  <!-- build:js -->
  <script src="node_modules/ohm-js/dist/ohm.js"></script>
  <script src="dst/audio.js"></script>
  <script src="dst/konnakkol.js"></script>
  <script src="dst/konnakkol-editor.js"></script>
  <script src="dst/app.js"></script>
  <!-- endbuild -->
  <style>

    body, .code, .konnakkol-editor textarea {
      font-family: Palatino;
    }

    body {
      font-size: 20px;
      line-height:30px;
      background:#ffffff;
    }

    #container {
      width: 100%;
      padding: 10px 20px;
      max-width: 800px;
      margin: 0 auto;
      background: #eeeeee;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Arial';
      font-weight: bold;
    }

    .konnakkol-editor {
      margin-bottom: 20px;
      background: #cbcbcb;
      padding: 10px;
    }

    .konnakkol-editor .button {
      border: none;
      background: #38c0ff;
      color: #ffffff;
      font-size: 20px;
      letter-spacing: 2px;
      padding: 10px 20px 10px 20px;
      text-decoration: none;
    }

    .konnakkol-editor .button:hover {
      background: #3cb0fd;
      text-decoration: none;
    }

    .code {
      background: #66cfff;
      color: #000000;
      padding:3px 5px;
    }

    .konnakkol-editor textarea {
      font-size:20px;
      line-height:30px;
      padding:5px;
      box-sizing: border-box;
      width: 100%;
    }

    .instructions {
      margin-bottom: 20px;
    }

    table {
      border-collapse: collapse;
      border-spacing: 0;
      empty-cells: show;
      border: 2px solid #9a9a9a;
      width: 100%;
    }

    td {
      padding: 0.5em 1em;
    }

    tr {
      border-top: 1px solid #9a9a9a;
      border-bottom: 1px solid #9a9a9a;
    }

    tr:nth-child(even) {
      background-color: #ffffff;
    }

    td:first-child {
      font-weight:bold;
      padding-right: 20px;
    }

  </style>
</head>
<body>
<div id="container">
  <h1>Konnakkol</h1>
</div>

</body>
<script>
  function makeExample(id, content, title='', instructionHTML='') {
    const container = document.createElement('div');
    container.id = id;

    if (title.length > 0) {
      const header = document.createElement('h2');
      header.textContent = title;
      container.appendChild(header);
    }

    if (instructionHTML.length > 0) {
      const instructions = document.createElement('div');
      instructions.innerHTML = instructionHTML;
      instructions.classList.add('instructions');
      container.appendChild(instructions);
    }

    const editor = new konnakkol.Editor(`${id}-editor`);
    editor.setContent(content);
    container.appendChild(editor.getHTML());

    return { container, editor };
  }

  function addExample (id, content, title, instructionHTML) {
    const example = makeExample(id, content, title, instructionHTML);
    document.getElementById('container').appendChild(example.container);
    return example;
  }

  addExample(
    'basic-play',
    'takadimitakajuna',
    'Play button',
    'Syllables and phrases can be written and played with the play button'
  );

  const keyCommand = addExample(
    'key-command',
    'takitatakitataka',
    'Keyboard shortcut',
    `You can also use a keyboard shortcut:
    <ol>
      <li>Click on the textbox</li>
      <li>Press <span class="code">cmd enter</span> (Mac)
      <span class="code">ctrl enter</span> (Windows / Linux)</li>
    </ol>`);
  keyCommand.editor.playButton.remove();

  const selection = addExample(
    'selection',
    `dhadhikinathom dhadhikinathom`,
    'Selection playback',
    'You can play just a part of the text by selecting it'
  );

  selection.editor.selectionStart = 12;
  selection.editor.selectionEnd = 23;

  addExample(
    'spaces',
    `taka dimi taka juna
takita takita taka`,
    'Whitespace',
    'Spaces and new lines are ignored, so you can format as you like'
  );

  addExample(
    'syllables',
    `ma la da ta
khe khu khi kki
tam tom tham thom
tha lang - gu tom`,
    'Syllables',
    `You can make up your own syllables
     <ul>
       <li>They must start with a consonant</li>
       <li>There must be one vowel</li>
       <li>You can have multiple vowels or consonants, e.g. tha or taa</li>
       <li>Consonants at the end are also ok, as long as there is no vowel after them</li>
     </ul>`
  );

  addExample(
    'rests',
    `dha---dhi---ki---na---thom---
dha--dhi--ki--na--thom--
dha-dhi-ki-na-thom-
dhadhikinathom tom ,
dhadhikinathom tom ,
dhadhikinathom tom`,
    'Rests/extensions',
    `You can extend a syllable by one akshara with <span class="code">-</span>
    or <span class="code">,</span>`
  );

  addExample('rests-2',
    `takadimi takajuna
takadimi takajuna
- dhadhikinathom dhadhikinathom dhadhikinathom
tom`,
  '',
  'Rests can also go at the start of a phrase'
);

  addExample('stresses',
    `Takadimi takaJuna
Takadimi takaJuna
- DhadhiKinathom DhadhiKinathom DhadhiKinathom Tham
    `,
    'Stresses',
    'Stresses can be added by capitalising the consonant of a syllable'
  );

  addExample('doubles',
    `Takadimi {Takadimi Takajuna} Tham`,
    'Double speed',
    `Use <span class="code">{</span> and <span class="code">}</span> around your
    konnakkol to double the speed`
  );

  addExample('multi-double',
    `Takadimi {takadimi} {{takadimi takadimi}} Tham`,
    '',
    'You can double as many times as you like'
  );

  addExample('nested-double',
    `{ Dhadiki{naka}thom Dhadiki{naka}thom Dhadiki{naka}thom} Tham`,
    '',
    'Or have nested doubling (doubles inside doubles)'
  );

  addExample('half-speed',
    `Takadimi [Takadimi]
[Takadimi [Taka]] Tham
    `,
    'Half speed',
    `For half speed use <span class="code">[</span> and
    <span class="code">]</span>, it works just like doubling`
  );

  addExample('mixed',
    `[Ta , ka , Ta ki ta]
[Ta ka] Takita [Ta ka] Takita
{[Ta ka] Takita [Ta ka] Takita} Tham`,
    'Mixed speed',
    'You can even mix double and half speed'
  );

  addExample('gati',
    `Takadimi Takajuna
g3 Takita Takita
g5 Dhadhikinathom Dhadhikinathom
g4 Kitathaka Kitathaka
g3 Kitathaka Kitathaka Kitathaka
Tom`,
    'Gati',
    `The gati can be changed with <span class="code">gN</span> where
    <span class="code">N</span> is the number of aksharas per beat <br>
    By default the gati is chatusra (4)`
  );

  addExample('tempo',
    `tempo 120 takadimi
kala 90 takadimi`,
    'Tempo / Kala',
    `Set the tempo with either <span class="code">tempo N</span> or
    <span class="code">kala N</span>`
  );

  addExample('repeats',
    `takadimi x 2`,
    'Repeats',
    `Phrases can be repeated by using <span class="code">x N</span> (spaces
    don't matter, <span class="code">x3</span> and <span class="code">x 3</span>
    are both ok`
  );

  addExample('repeats-parens',
    `(taka x2 takita) x2`,
    'Brackets',
    `Round brackets can be used to disambiguate repeats`
  );

  addExample('repeats-parens-without',
    `taka x2 takita x2`,
    '',
    `without the brackets this would be: <span class="code">(taka x2) (takita x2)</span>`
  );

  addExample('homework',
    `((Takadimi x 7) TakaTakita) x 3
((Takadimi x 6) TakaTakita) Tom`,
    '',
    `This makes it easy to write out exercises like this classic`
  );

  const free = addExample('free',
    ``,
    'Go wild!',
    `<p>Write your own! All of the examples on this page are editable, so feel
    free to edit and play with them too.</p>

    <table>
      <tbody>
        <tr>
          <td>Syllables</td>
          <td>
            start with a consonant, must have a vowel
            <span class="code">ta tha tham</span>
          </td>
        </tr>
        <tr>
          <td>Rest/extension</td>
          <td><span class="code">-</span> or <span class="code">,</span></td>
        </tr>
        <tr>
          <td>Stresses</td>
          <td>Upper case <span class="code">TakaTakita</span></td>
        </tr>
        <tr>
          <td>Double Speed</td>
          <td><span class="code">{ takadimi } {{takadimi}}</span></td>
        </tr>
        <tr>
          <td>Half Speed</td>
          <td><span class="code">[ takadimi ] [[ takadimi ]]</span></td>
        </tr>
        <tr>
          <td>Gati</td>
          <td><span class="code">g3 g4 g5</span> etc...</td>
        </tr>
        <tr>
          <td>Repeats</td>
          <td><span class="code">takadimi x2</span> use brackets if necessary
            <span class="code">(takadimi x 2)</span>
          </td>
        </tr>
      </tbody>
    </table>
    `
  );

  free.editor.textarea.rows = 8;

</script>
</html>